<div class="branches-container">
  <div class="table-header">
    <div class="header-left">
      <div class="header-icon">
        <mat-icon>business</mat-icon>
      </div>
      <h3>Branches</h3>
    </div>
    <div class="header-actions">
      <mat-form-field appearance="outline" class="search-box">
        <mat-icon matPrefix>search</mat-icon>
        <input
          matInput
          placeholder="Search branches..."
          [ngModel]="searchQuery()"
          (ngModelChange)="searchQuery.set($event); onSearch()"
        />
      </mat-form-field>
      <button mat-raised-button color="primary" (click)="addBranch()">
        <mat-icon>add</mat-icon> Add Branch
      </button>
    </div>
  </div>

  <div class="table-wrapper">
    <table class="branches-table">
      <thead>
        <tr>
          <th>Name</th>
          <th>Date Added</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let branch of filteredBranches()">
          <td>{{ branch.name }}</td>
          <td>{{ branch.dateAdded | date: 'mediumDate' }}</td>
          <td>
            <span
              class="status-badge"
              [ngClass]="branch.status === 'Deleted' ? 'inactive' : 'active'"
            >
              {{ branch.status }}
            </span>
          </td>
          <td class="actions-col">
            <button
              mat-icon-button
              color="primary"
              matTooltip="Edit"
              (click)="editBranch(branch)"
            >
              <mat-icon>edit</mat-icon>
            </button>
            <button
              mat-icon-button
              color="warn"
              matTooltip="Delete"
              (click)="deleteBranch(branch)"
            >
              <mat-icon>delete</mat-icon>
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="pagination" *ngIf="totalCount()">
    <div class="pagination-info">
      Showing {{ displayRange().start }} to {{ displayRange().end }} of
      {{ displayRange().total }} branches
    </div>
    <div class="pagination-controls">
      <mat-form-field appearance="outline">
        <mat-select [value]="pageSize()" (selectionChange)="changePageSize($event)">
          <mat-option *ngFor="let size of pageSizeOptions()" [value]="size">
            {{ size }} per page
          </mat-option>
        </mat-select>
      </mat-form-field>
      <button
        mat-raised-button
        (click)="firstPage()"
        [disabled]="currentPage() === 1"
      >
        First
      </button>
      <button
        mat-raised-button
        (click)="previousPage()"
        [disabled]="currentPage() === 1"
      >
        Previous
      </button>
      <button
        mat-raised-button
        *ngFor="let page of getPageNumbers()"
        [color]="page === currentPage() ? 'primary' : 'basic'"
        (click)="page > 0 ? goToPage(page) : null"
      >
        {{ page > 0 ? page : '...' }}
      </button>
      <button
        mat-raised-button
        (click)="nextPage()"
        [disabled]="currentPage() === totalPages()"
      >
        Next
      </button>
      <button
        mat-raised-button
        (click)="lastPage()"
        [disabled]="currentPage() === totalPages()"
      >
        Last
      </button>
    </div>
  </div>

  <mat-spinner *ngIf="loading()" class="spinner"></mat-spinner>
  <div class="error" *ngIf="errorMessage()">{{ errorMessage() }}</div>
</div>
