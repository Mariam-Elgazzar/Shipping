<div class="auth-form-container">
  <h2>Change Password</h2>
  <p>Create a new password for your account</p>

  <form
    [formGroup]="changePasswordForm"
    (ngSubmit)="onSubmit()"
    class="auth-form"
  >
    <div class="form-group">
      <label for="oldpassword">Current Password</label>
      <div class="password-input">
        <input
          [type]="hideOldPassword ? 'password' : 'text'"
          id="oldpassword"
          formControlName="oldpassword"
          placeholder="Enter current password"
          [ngClass]="{
            'is-invalid':
              changePasswordForm.controls['oldpassword'].invalid &&
              changePasswordForm.controls['oldpassword'].touched
          }"
        />
        <button
          type="button"
          class="password-toggle"
          (click)="togglePasswordVisibility('oldpassword')"
        >
          <i class="icon-eye"></i>
        </button>
      </div>
      <div
        class="error-message"
        *ngIf="
          changePasswordForm.controls['oldpassword'].invalid &&
          changePasswordForm.controls['oldpassword'].touched
        "
      >
        <span
          *ngIf="changePasswordForm.controls['oldpassword'].errors?.['required']"
          >Current password is required</span
        >
        <span
          *ngIf="changePasswordForm.controls['oldpassword'].errors?.['minlength']"
          >Current password must be at least 8 characters</span
        >
      </div>
    </div>

    <div class="form-group">
      <label for="password">New Password</label>
      <div class="password-input">
        <input
          [type]="hidePassword ? 'password' : 'text'"
          id="password"
          formControlName="password"
          placeholder="Enter new password"
          [ngClass]="{
            'is-invalid':
              changePasswordForm.controls['password'].invalid &&
              changePasswordForm.controls['password'].touched
          }"
        />
        <button
          type="button"
          class="password-toggle"
          (click)="togglePasswordVisibility('password')"
        >
          <i class="icon-eye"></i>
        </button>
      </div>
      <div
        class="error-message"
        *ngIf="
          changePasswordForm.controls['password'].invalid &&
          changePasswordForm.controls['password'].touched
        "
      >
        <span
          *ngIf="changePasswordForm.controls['password'].errors?.['required']"
          >New password is required</span
        >
        <span
          *ngIf="changePasswordForm.controls['password'].errors?.['minlength']"
          >New password must be at least 8 characters</span
        >
      </div>
    </div>

    <div class="form-group">
      <label for="confirmPassword">Confirm New Password</label>
      <div class="password-input">
        <input
          [type]="hideConfirmPassword ? 'password' : 'text'"
          id="confirmPassword"
          formControlName="confirmPassword"
          placeholder="Confirm new password"
          [ngClass]="{
            'is-invalid':
              (changePasswordForm.controls['confirmPassword'].invalid ||
                changePasswordForm.hasError('notMatching')) &&
              changePasswordForm.controls['confirmPassword'].touched
          }"
        />
        <button
          type="button"
          class="password-toggle"
          (click)="togglePasswordVisibility('confirmPassword')"
        >
          <i class="icon-eye"></i>
        </button>
      </div>
      <div
        class="error-message"
        *ngIf="
          (changePasswordForm.controls['confirmPassword'].invalid ||
            changePasswordForm.hasError('notMatching')) &&
          changePasswordForm.controls['confirmPassword'].touched
        "
      >
        <span
          *ngIf="
            changePasswordForm.controls['confirmPassword'].errors?.['required']
          "
          >Confirm password is required</span
        >
        <span *ngIf="changePasswordForm.hasError('notMatching')"
          >Passwords do not match</span
        >
      </div>
    </div>

    <div class="auth-actions">
      <button
        type="submit"
        class="btn-primary"
        [disabled]="changePasswordForm.invalid || loading"
      >
        <div class="spinner" *ngIf="loading"></div>
        <span *ngIf="!loading">Change Password</span>
      </button>
    </div>

    <div class="auth-links">
      <a [routerLink]="['/login']">Back to Login</a>
    </div>
  </form>
</div>
